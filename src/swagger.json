{
  "openapi": "3.0.3",
  "info": {
    "title": "IronChallenge API",
    "description": "Documentação da API IronChallenge",
    "termsOfService": "http://swagger.io/terms/",
    "version": "1.0.0",
    "contact": {
      "name": "Bruno",
      "email": "mello.bruno@live.com"
    }
  },
  "servers": [
    { "url": "http://localhost:3333", "description": "Local" }
  ],
  "tags": [
    { "name": "Championship", "description": "Rotas de campeonato" },
    { "name": "Event", "description": "Rotas de evento" },
    { "name": "Registrations", "description": "Rotas de inscrição" },
    { "name": "User", "description": "Rotas de usuário" }
  ],
  "components": {
  "securitySchemes": {
    "bearerAuth": {
      "type": "http",
      "scheme": "bearer",
      "bearerFormat": "JWT"
    }
  }
},
  "paths": {
    "/championship/generateEntry": {
      "post": {
        "tags": ["Championship"],
        "summary": "Gera a ordem de entrada do campeonato",
        "parameters": [
          { "name": "authorization", "in": "header", "required": true, "schema": { "type": "string" } },
          { "name": "eventId", "in": "query", "required": true, "schema": { "type": "string" } },
          { "name": "categoryId", "in": "query", "required": true, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Ordem gerada com sucesso" } }
      }
    },
    "/championship/orderList": {
      "get": {
        "tags": ["Championship"],
        "summary": "Lista a ordem de entrada",
        "parameters": [
          { "name": "authorization", "in": "header", "required": true, "schema": { "type": "string" } },
          { "name": "eventId", "in": "query", "required": true, "schema": { "type": "string" } },
          { "name": "categoryId", "in": "query", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Ordem retornada com sucesso",
            "content": { "application/json": { "schema": { "type": "array", "items": { "type": "object" } } } }
          }
        }
      }
    },
    "/championship/score": {
      "patch": {
        "tags": ["Championship"],
        "summary": "Atualiza pontos de um competidor",
        "parameters": [
          { "name": "authorization", "in": "header", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "_id": { "type": "string" },
                  "eventId": { "type": "string" },
                  "categoryId": { "type": "string" },
                  "attended": { "type": "boolean", "nullable": true },
                  "repetition": { "type": "number", "nullable": true }
                },
                "required": ["_id", "eventId", "categoryId"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Pontuação atualizada" } }
      }
    },
    "/championship/result": {
      "get": {
        "tags": ["Championship"],
        "summary": "Retorna o resultado em tempo real",
        "parameters": [
          { "name": "authorization", "in": "header", "required": true, "schema": { "type": "string" } },
          { "name": "eventId", "in": "query", "required": true, "schema": { "type": "string" } },
          { "name": "categoryId", "in": "query", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Resultado retornado com sucesso",
            "content": { "application/json": { "schema": { "type": "object" } } }
          }
        }
      }
    },
    "/championship/winners": {
      "patch": {
        "tags": ["Championship"],
        "summary": "Gera o ranking final e salva as posições",
        "parameters": [
          { "name": "authorization", "in": "header", "required": true, "schema": { "type": "string" } },
          { "name": "eventId", "in": "query", "required": true, "schema": { "type": "string" } },
          { "name": "categoryId", "in": "query", "required": true, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Ranking final gerado" } }
      }
    },

    "/event": {
      "post": {
        "tags": ["Event"],
        "summary": "Cria um novo evento",
         "security": [
          { "bearerAuth": [] }
          ],        
        "parameters": [
         
        ],
        
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "description": { "type": "string" },
                  "startDate": { "type": "string", "format": "date-time" },
                  "finishDate": { "type": "string", "format": "date-time" },
                  "categories": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "weightRequirement": { "type": "number" }
                      },
                      "required": ["name","weightRequirement"]
                    }
                  }
                },
                "required": ["name","description","startDate","finishDate","categories"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Evento criado com sucesso" } }
      }
    },
    "/events/{id}": {
      "delete": {
      "summary": "Deletar evento",
      "description": "Remove um evento existente. Apenas o organizador do evento pode deletá-lo.",
      "tags": ["Event"],
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "description": "ID do evento a ser deletado.",
          "schema": {
            "type": "string"
          }
        }
      ],
      "security": [{ "bearerAuth": [] }],
      "responses": {
        "200": {
          "description": "Evento deletado com sucesso.",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Evento deletado com sucesso."
                  }
                }
              }
            }
          }
        },
        "401": {
          "description": "Token não fornecido.",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Token não fornecido."
                  }
                }
              }
            }
          }
        },
        "403": {
          "description": "Usuário não é o organizador do evento.",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Acesso negado. Você não é o organizador deste evento."
                  }
                }
              }
            }
          }
        },
        "404": {
          "description": "Evento ou usuário não encontrado.",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Evento não encontrado."
                  }
                }
              }
            }
          }
        },
        "500": {
          "description": "Erro interno ao deletar evento.",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Erro ao deletar evento."
                  }
                }
              }
            }
          }
        }
      }
    }   
    },

 "/registrations": {
    "post": {
      "tags": ["Registrations"],
      "summary": "Cria uma nova inscrição",
      "description": "Cria uma inscrição para um competidor em um evento e categoria específicos.",
      "security": [
        { "bearerAuth": [] }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "required": ["eventId", "categoryId", "competitorWeight"],
              "properties": {
                "eventId": {
                  "type": "string",
                  "example": "671fb2f43f84cba9f84dfe90"
                },
                "categoryId": {
                  "type": "string",
                  "example": "671fb3127f84cba9f84dfe93"
                },
                "competitorWeight": {
                  "type": "number",
                  "example": 82.5
                }
              }
            }
          }
        }
      },
      "responses": {
        "201": { "description": "Inscrição criada com sucesso." },
        "400": { "description": "Token ausente ou inválido." },
        "500": { "description": "Erro interno do servidor." }
      }
    }
  },
  "/registrations/{registrationId}": {
    "patch": {
      "tags": ["Registrations"],
      "summary": "Atualiza uma inscrição existente",
      "description": "Permite alterar os dados de uma inscrição, como categoria ou peso do competidor.",
      "security": [
        { "bearerAuth": [] }
      ],
      "parameters": [
        {
          "in": "path",
          "name": "registrationId",
          "required": true,
          "schema": { "type": "string" },
          "description": "ID da inscrição a ser atualizada"
        }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "categoryId": { "type": "string" },
                "competitorWeight": { "type": "number" }
              }
            }
          }
        }
      },
      "responses": {
        "200": { "description": "Inscrição atualizada com sucesso." },
        "400": { "description": "Token inválido ou parâmetros incorretos." },
        "404": { "description": "Inscrição não encontrada." }
      }
    }
  },
  "/registrations/list": {
    "get": {
      "tags": ["Registrations"],
      "summary": "Lista inscrições",
      "description": "Retorna todas as inscrições, podendo filtrar por evento ou categoria.",
      "security": [
        { "bearerAuth": [] }
      ],
      "parameters": [
        {
          "in": "query",
          "name": "eventId",
          "schema": { "type": "string" },
          "required": false,
          "description": "ID do evento para filtrar"
        },
        {
          "in": "query",
          "name": "categoryId",
          "schema": { "type": "string" },
          "required": false,
          "description": "ID da categoria para filtrar"
        }
      ],
      "responses": {
        "200": { "description": "Lista de inscrições retornada com sucesso." },
        "400": { "description": "Token inválido." },
        "500": { "description": "Erro interno do servidor." }
      }
    }
  },
  "/registrations/{id}": {
  "delete": {
    "tags": ["Registrations"],
    "summary": "Remove uma inscrição",
    "description": "Deleta uma inscrição existente pelo ID. Requer autenticação via token Bearer.",
    "security": [
      { "bearerAuth": [] }
    ],
    "parameters": [
      {
        "name": "id",
        "in": "path",
        "required": true,
        "schema": { "type": "string" },
        "description": "ID da inscrição a ser deletada"
      },
      {
        "name": "Authorization",
        "in": "header",
        "required": true,
        "schema": { "type": "string", "example": "Bearer seu_token_aqui" },
        "description": "Token JWT no formato Bearer para autenticação"
      }
    ],
    "responses": {
      "200": {
        "description": "Inscrição removida com sucesso."
      },
      "400": {
        "description": "Token inválido ou mal formatado."
      },
      "403": {
        "description": "Usuário sem permissão para deletar esta inscrição."
      },
      "404": {
        "description": "Inscrição não encontrada."
      }
    }
  }
},


    "/user": {
      "post": {
        "tags": ["User"],
        "summary": "Cria ou autentica um usuário via token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "type": "object", "properties": { "token": { "type": "string" } }, "required": ["token"] }
            }
          }
        },
        "responses": { "200": { "description": "Usuário criado ou autenticado" } }
      }
    }
  }
}
